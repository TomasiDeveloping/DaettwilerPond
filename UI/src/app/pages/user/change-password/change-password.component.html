<div class="container">
  <h2 class="text-center mt-3">Passwort ändern</h2>
  <form (ngSubmit)="onSubmit()" [formGroup]="changePasswordForm">
    <div class="form-group">
      <div class="form-group">
        <label class="form-label" for="currentPassword">Aktuelles Passwort</label>
        <div class="input-group">
          <input [ngClass]="{
      'is-invalid': currentPassword?.invalid && (currentPassword?.dirty || currentPassword?.touched),
      'is-valid': currentPassword?.valid
      }" [type]="isInputText ? 'text' : 'password'" class="form-control" formControlName="currentPassword"
            id="currentPassword">
            <span (click)="isInputText = !isInputText" class="input-group-text eye-icon"><i
              [ngClass]="isInputText ? 'bi-eye-slash-fill' : 'bi-eye-fill'"
            class="bi"></i></span>
            @if (currentPassword?.errors && (currentPassword?.dirty || currentPassword?.touched)) {
              <div
                class="invalid-feedback">
                @if (confirmPassword?.hasError('required')) {
                  <p>Aktuelles Passwort ist ein Pflichtfeld</p>
                }
              </div>
            }
          </div>
        </div>
        <div class="form-group">
          <label class="form-label" for="password">Neues Passwort</label>
          <div class="input-group">
          <input [ngClass]="{
      'is-invalid': password?.invalid && (password?.dirty || password?.touched),
      'is-valid': password?.valid
      }" [type]="isInputText ? 'text' : 'password'" class="form-control" formControlName="password" id="password">
              <span (click)="isInputText = !isInputText" class="input-group-text eye-icon"><i
                [ngClass]="isInputText ? 'bi-eye-slash-fill' : 'bi-eye-fill'"
              class="bi"></i></span>
              @if (password?.hasError && (password?.dirty || password?.touched)) {
                <div class="invalid-feedback">
                  @if (password?.hasError('required')) {
                    <p>Passwort ist ein Pflichtfeld</p>
                  }
                  @if (!password?.hasError('required')) {
                    <div>
                      <div [ngClass]="password?.hasError('hasNumber') ? 'text-danger': 'text-success'">
                        <i [ngClass]="password?.hasError('hasNumber') ? 'bi bi-x-square-fill' : 'bi bi-check-square-fill'"></i>
                        Muss mindestens 1 Nummer haben!
                      </div>
                      <div [ngClass]="password?.hasError('minlength') ? 'text-danger': 'text-success'">
                        <i [ngClass]="password?.hasError('minlength') ? 'bi bi-x-square-fill' : 'bi bi-check-square-fill'"></i>
                        Muss mindestens 8 Zeichen lang sein!
                      </div>
                      <div [ngClass]="password?.hasError('hasCapitalCase') ? 'text-danger': 'text-success'">
                        <i
                        [ngClass]="password?.hasError('hasCapitalCase') ? 'bi bi-x-square-fill' : 'bi bi-check-square-fill'"></i>
                        Muss mindestens 1 in Großbuchstaben enthalten!
                      </div>
                      <div [ngClass]="password?.hasError('hasSmallCase') ? 'text-danger': 'text-success'">
                        <i
                        [ngClass]="password?.hasError('hasSmallCase') ? 'bi bi-x-square-fill' : 'bi bi-check-square-fill'"></i>
                        Muss mindestens 1 Buchstabe in Kleinbuchstaben enthalten!
                      </div>
                      <div [ngClass]="password?.hasError('hasSpecialCharacters') ? 'text-danger': 'text-success'">
                        <i
                        [ngClass]="password?.hasError('hasSpecialCharacters') ? 'bi bi-x-square-fill' : 'bi bi-check-square-fill'"></i>
                        Muss mindestens 1 Sonderzeichen enthalten!
                      </div>
                    </div>
                  }
                </div>
              }
            </div>
          </div>
          <div class="form-group">
            <label class="form-label" for="confirmPassword">Passwort wiederholen</label>
            <div class="input-group">
          <input [ngClass]="{
      'is-invalid': confirmPassword?.invalid && (confirmPassword?.dirty || confirmPassword?.touched),
      'is-valid': confirmPassword?.valid
      }" [type]="isInputText ? 'text' : 'password'" class="form-control" formControlName="confirmPassword"
                id="confirmPassword">
                <span (click)="isInputText = !isInputText" class="input-group-text eye-icon"><i
                  [ngClass]="isInputText ? 'bi-eye-slash-fill' : 'bi-eye-fill'"
                class="bi"></i></span>
                @if (confirmPassword?.errors && (confirmPassword?.dirty || confirmPassword?.touched)) {
                  <div
                    class="invalid-feedback">
                    @if (confirmPassword?.hasError('required')) {
                      <p>Passwort wiederholen ist ein Pflichtfeld</p>
                    }
                    @if (confirmPassword?.hasError('passwordMismatch')) {
                      <p>Passwörter stimmen nicht überein</p>
                    }
                  </div>
                }
              </div>
            </div>
            <div class="d-grid mt-5">
              <button [disabled]="changePasswordForm.invalid" class="btn btn-success" type="submit">Absenden</button>
            </div>
          </div>
        </form>
      </div>
